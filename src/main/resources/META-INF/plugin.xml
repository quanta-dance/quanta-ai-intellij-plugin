<!-- Plugin Configuration File. Read more: https://plugins.jetbrains.com/docs/intellij/plugin-configuration-file.html -->
<idea-plugin url="https://github.com/quanta-dance/quanta-ai-intelliJ-plugin" require-restart="false">
    <!-- Unique identifier of the plugin. It should be FQN. It cannot be changed between the plugin versions. -->
    <id>com.github.quantadance.quanta-ai-intellij-plugin</id>

    <!-- Public plugin name should be written in Title Case.
         Guidelines: https://plugins.jetbrains.com/docs/marketplace/plugin-overview-page.html#plugin-name -->
    <name>Quanta AI</name>

    <!-- A displayed Vendor name or Organization ID displayed on the Plugins Page. -->
    <vendor url="https://github.com/quanta-dance">Quanta Dance Tech.</vendor>

    <!-- Description of the plugin displayed on the Plugin Page and IDE Plugin Manager.
         Simple HTML elements (text formatting, paragraphs, and lists) can be added inside of <![CDATA[ ]]> tag.
         Guidelines: https://plugins.jetbrains.com/docs/marketplace/plugin-overview-page.html#plugin-description -->
    <description><![CDATA[
    <h2>Quanta — AI coding assistant for IntelliJ</h2>

    <p>Quanta AI integrates a context-aware AI assistant directly into your IntelliJ-based IDE. Access intelligent code review, refactoring suggestions, and conversational prompts right from the editor or the Quanta Dance tool window.</p>

    <h3>Key features</h3>
    <ul>
      <li><b>Contextual code review:</b> Select code and receive actionable feedback on bugs, performance, and style.</li>
      <li><b>AI-powered refactoring:</b> Get safe refactor suggestions and automated edits to improve readability and maintainability.</li>
      <li><b>Inline prompts & custom actions:</b> Prompt the AI from the editor or use built-in actions (Review, Refactor, Comment, Custom) to accelerate common tasks.</li>
      <li><b>Conversational assistant with voice:</b> Optional voice input/output for hands-free interactions and faster workflows.</li>
      <li><b>Configurable settings & persistence:</b> Configure API host, tokens, model preferences, and other options via the plugin settings.</li>
      <li><b>Seamless IDE integration:</b> Tool window, context menus, and floating toolbar allow you to use AI where you already work.</li>
    </ul>

    <h3>Why choose Quanta AI?</h3>
    <p>Quanta AI helps teams and individual developers save time on code review and repetitive refactorings by delivering contextual AI recommendations in-place. It improves code quality, accelerates onboarding, and reduces cognitive load.</p>

    <h3>Get started</h3>
    <ol>
      <li>Install Quanta AI and open the Quanta Dance tool window.</li>
      <li>Configure your API token in Settings → Quanta AI.</li>
      <li>Use editor actions or the tool window to request reviews, refactors, or custom prompts.</li>
    </ol>

    <p>For documentation and support, visit <a href="https://github.com/quanta-dance">https://github.com/quanta-dance/quanta-ai-intellij-plugin</a>.</p>
  ]]></description>

    <change-notes>
        Fix model selection for gpt-5.1 and gpt-5.1-codex
    </change-notes>


    <!-- Product and plugin compatibility requirements.
         Read more: https://plugins.jetbrains.com/docs/intellij/plugin-compatibility.html -->
    <depends>com.intellij.modules.platform</depends>
    <depends>com.intellij.modules.vcs</depends>
    <depends>Git4Idea</depends>
    <!-- Optional Java plugin dependency; config-file will be loaded only when available (e.g., IntelliJ IDEA) -->
    <depends optional="true" config-file="java.xml">com.intellij.java</depends>
    <depends>com.intellij.gradle</depends>
    <resource-bundle>messages.QuantaAIBundle</resource-bundle>

    <!-- Extension points defined by the plugin.
         Read more: https://plugins.jetbrains.com/docs/intellij/plugin-extension-points.html -->
    <extensions defaultExtensionNs="com.intellij">
        <toolWindow factoryClass="com.github.quantadance.quanta.plugins.intellij.toolWindow.QuantaAIToolWindowFactory"
                    id="Quanta AI"
                    icon="/icons/quantadance.svg"
                    anchor="right"/>

        <!-- Ensure MCP watcher is instantiated on project open -->
        <postStartupActivity
                implementation="com.github.quantadance.quanta.plugins.intellij.mcp.McpServersStartupActivity"/>
    </extensions>

    <applicationListeners>
        <listener
                class="com.github.quantadance.quanta.plugins.intellij.listeners.QuantaAIApplicationActivationListener"
                topic="com.intellij.openapi.application.ApplicationActivationListener"/>
    </applicationListeners>

    <!-- Will add Plugin Configuration Settings into Settings -> QuantaDance Plugin Settings -->
    <extensions defaultExtensionNs="com.intellij">
        <applicationService
                serviceImplementation="com.github.quantadance.quanta.plugins.intellij.settings.QuantaAISettingsState"/>
        <applicationConfigurable
                parentId="tools"
                id="com.github.quantadance.quanta.plugins.intellij.settings.QuantaAIPluginConfigurable"
                displayName="Quanta AI"
                instance="com.github.quantadance.quanta.plugins.intellij.settings.QuantaAIPluginConfigurable"/>
        <notificationGroup id="Plugin Notifications"
                           displayType="STICKY_BALLOON"
                           isLogByDefault="true"/>
    </extensions>

    <actions>
        <group id="EditorPopupMenu.QuantaAI"
               class="com.intellij.openapi.actionSystem.DefaultActionGroup"
               text="QuantaDance Actions" popup="true" description="QuantaDance"
               icon="/icons/quantadance.svg">
            <add-to-group group-id="EditorPopupMenu" anchor="first"/>
        </group>

        <group id="Floating.CodeToolbar.QuantaAI"
               class="com.intellij.openapi.actionSystem.DefaultActionGroup"
               text="QuantaAI Actions" popup="true" description="QuantaAI"
               icon="/icons/quantadance.svg">
            <add-to-group group-id="Floating.CodeToolbar" anchor="first"/>
        </group>

        <action id="ReviewSelectedAction"
                class="com.github.quantadance.quanta.plugins.intellij.actions.ReviewSelectedAction"
                text="Review Selected Code"
                description="Review code by AI">
            <add-to-group group-id="EditorPopupMenu.QuantaAI"/>
            <add-to-group group-id="Floating.CodeToolbar.QuantaAI"/>
        </action>

        <action id="RefactorSelectedAction"
                class="com.github.quantadance.quanta.plugins.intellij.actions.RefactorSelectedAction"
                text="Refactor Selected Code"
                description="Refactor code by AI">
            <add-to-group group-id="EditorPopupMenu.QuantaAI"/>
            <add-to-group group-id="Floating.CodeToolbar.QuantaAI"/>
        </action>

        <action id="CommentSelectedAction"
                class="com.github.quantadance.quanta.plugins.intellij.actions.CommentSelectedAction"
                text="Add Comments to the Code"
                description="Add Comments to the code by AI">
            <add-to-group group-id="EditorPopupMenu.QuantaAI"/>
            <add-to-group group-id="Floating.CodeToolbar.QuantaAI"/>
        </action>

        <action id="CustomUserAction"
                class="com.github.quantadance.quanta.plugins.intellij.actions.CustomUserAction"
                text="Custom User Action"
                description="Execute AI Prompt defined by user">
            <add-to-group group-id="EditorPopupMenu.QuantaAI"/>
            <add-to-group group-id="Floating.CodeToolbar.QuantaAI"/>
        </action>

        <action id="SettingsAction"
                class="com.github.quantadance.quanta.plugins.intellij.actions.SettingsAction"
                text="Quanta AI Settings"
                description="Open Quanta AI plugin settings"
                icon="AllIcons.General.Settings">
        </action>
    </actions>
</idea-plugin>
